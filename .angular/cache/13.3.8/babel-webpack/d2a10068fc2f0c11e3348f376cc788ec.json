{"ast":null,"code":"import { InjectionToken, Injectable, Inject, NgModule, Optional, SkipSelf, ɵɵdefineInjectable, ɵɵinject, Component, Input, EventEmitter, Output, HostBinding, HostListener } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { HttpHeaders, HttpClient, HttpErrorResponse, HttpBackend, HttpClientModule, HttpParams } from '@angular/common/http';\nimport { UohStore, UohLogger, UohEnvironment, UOH_ENVIRONMENT, UohEnvironmentModule, UohLogLevel } from '@haifauniversity/ngx-tools';\nimport { throwError, timer, Subject, BehaviorSubject, of, Subscription } from 'rxjs';\nimport { map, retryWhen, tap, catchError, mergeMap, filter, share, takeUntil, distinctUntilChanged, switchMap } from 'rxjs/operators';\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\nimport { MatDialogModule, MatDialog } from '@angular/material/dialog';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatButtonModule } from '@angular/material/button';\nimport { DomSanitizer } from '@angular/platform-browser';\nimport { MatDividerModule } from '@angular/material/divider';\nimport * as ɵngcc0 from '@angular/core';\nimport * as ɵngcc1 from '@angular/common/http';\nimport * as ɵngcc2 from '@haifauniversity/ngx-tools';\nimport * as ɵngcc3 from '@angular/material/dialog';\nimport * as ɵngcc4 from '@angular/material/icon';\nimport * as ɵngcc5 from '@angular/material/button';\nimport * as ɵngcc6 from '@angular/platform-browser';\nimport * as ɵngcc7 from '@angular/common';\nimport * as ɵngcc8 from '@angular/material/progress-bar';\nimport * as ɵngcc9 from '@angular/material/divider';\nconst _c0 = \".mat-dialog-courses[_ngcontent-%COMP%]{align-items:center;display:flex}.mat-dialog-courses[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:7px;opacity:.82}[dir=rtl][_nghost-%COMP%]   .mat-dialog-courses[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   .mat-dialog-courses[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-left:7px;margin-right:0}.mat-dialog-actions[_ngcontent-%COMP%]{justify-content:center}\";\n\nfunction UohPayPageComponent_ng_container_0_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementContainerStart(0);\n    ɵngcc0.ɵɵelement(1, \"mat-progress-bar\", 3);\n    ɵngcc0.ɵɵelementStart(2, \"div\", 4);\n    ɵngcc0.ɵɵtext(3, \"\\u05E0\\u05D0 \\u05DC\\u05D4\\u05DE\\u05EA\\u05D9\\u05DF.\");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementStart(4, \"div\", 4);\n    ɵngcc0.ɵɵelementStart(5, \"b\");\n    ɵngcc0.ɵɵtext(6, \"\\u05D0\\u05D9\\u05DF \\u05DC\\u05E1\\u05D2\\u05D5\\u05E8 \\u05D0\\u05EA \\u05D4\\u05D7\\u05DC\\u05D5\\u05DF.\");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementContainerEnd();\n  }\n}\n\nfunction UohPayPageComponent_button_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = ɵngcc0.ɵɵgetCurrentView();\n\n    ɵngcc0.ɵɵelementStart(0, \"button\", 5);\n    ɵngcc0.ɵɵlistener(\"click\", function UohPayPageComponent_button_4_Template_button_click_0_listener() {\n      ɵngcc0.ɵɵrestoreView(_r3);\n      const ctx_r2 = ɵngcc0.ɵɵnextContext();\n      return ctx_r2.setMock();\n    });\n    ɵngcc0.ɵɵtext(1, \"\\u05D4\\u05DE\\u05E9\\u05DA\");\n    ɵngcc0.ɵɵelementEnd();\n  }\n}\n\nfunction UohPaySuccessComponent_ng_container_34_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"div\", 2);\n    ɵngcc0.ɵɵelementStart(1, \"span\", 3);\n    ɵngcc0.ɵɵtext(2, \" \\u05DE\\u05E1\\u05E4\\u05E8 \\u05EA\\u05E9\\u05DC\\u05D5\\u05DE\\u05D9\\u05DD: \");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementStart(3, \"span\", 4);\n    ɵngcc0.ɵɵtext(4);\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = ɵngcc0.ɵɵnextContext(2);\n    ɵngcc0.ɵɵadvance(4);\n    ɵngcc0.ɵɵtextInterpolate1(\" \", ctx_r1.payment.installments.quantity, \" \");\n  }\n}\n\nfunction UohPaySuccessComponent_ng_container_34_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"div\", 2);\n    ɵngcc0.ɵɵelementStart(1, \"span\", 3);\n    ɵngcc0.ɵɵtext(2, \" \\u05E1\\u05DB\\u05D5\\u05DD \\u05EA\\u05E9\\u05DC\\u05D5\\u05DD \\u05E8\\u05D0\\u05E9\\u05D5\\u05DF: \");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementStart(3, \"span\", 4);\n    ɵngcc0.ɵɵtext(4);\n    ɵngcc0.ɵɵpipe(5, \"currency\");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = ɵngcc0.ɵɵnextContext(2);\n    ɵngcc0.ɵɵadvance(4);\n    ɵngcc0.ɵɵtextInterpolate1(\" \", ɵngcc0.ɵɵpipeBind4(5, 1, ctx_r2.payment.installments.firstSum, ctx_r2.payment.currency, true, \"1.2-2\"), \" \");\n  }\n}\n\nfunction UohPaySuccessComponent_ng_container_34_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"div\", 2);\n    ɵngcc0.ɵɵelementStart(1, \"span\", 3);\n    ɵngcc0.ɵɵtext(2, \" \\u05E1\\u05DB\\u05D5\\u05DD \\u05EA\\u05E9\\u05DC\\u05D5\\u05DD \\u05E2\\u05D5\\u05E7\\u05D1: \");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementStart(3, \"span\", 4);\n    ɵngcc0.ɵɵtext(4);\n    ɵngcc0.ɵɵpipe(5, \"currency\");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = ɵngcc0.ɵɵnextContext(2);\n    ɵngcc0.ɵɵadvance(4);\n    ɵngcc0.ɵɵtextInterpolate1(\" \", ɵngcc0.ɵɵpipeBind4(5, 1, ctx_r3.payment.installments.sum, ctx_r3.payment.currency, true, \"1.2-2\"), \" \");\n  }\n}\n\nfunction UohPaySuccessComponent_ng_container_34_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementContainerStart(0);\n    ɵngcc0.ɵɵelement(1, \"mat-divider\");\n    ɵngcc0.ɵɵtemplate(2, UohPaySuccessComponent_ng_container_34_div_2_Template, 5, 1, \"div\", 6);\n    ɵngcc0.ɵɵelement(3, \"mat-divider\");\n    ɵngcc0.ɵɵtemplate(4, UohPaySuccessComponent_ng_container_34_div_4_Template, 6, 6, \"div\", 6);\n    ɵngcc0.ɵɵelement(5, \"mat-divider\");\n    ɵngcc0.ɵɵtemplate(6, UohPaySuccessComponent_ng_container_34_div_6_Template, 6, 6, \"div\", 6);\n    ɵngcc0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(2);\n    ɵngcc0.ɵɵproperty(\"ngIf\", ctx_r0.payment.installments.quantity);\n    ɵngcc0.ɵɵadvance(2);\n    ɵngcc0.ɵɵproperty(\"ngIf\", ctx_r0.payment.installments.firstSum);\n    ɵngcc0.ɵɵadvance(2);\n    ɵngcc0.ɵɵproperty(\"ngIf\", ctx_r0.payment.installments.sum);\n  }\n}\n\nfunction UohPayFailureComponent_ng_container_0_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"div\", 2);\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = ɵngcc0.ɵɵnextContext(2);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate1(\" \\u05E7\\u05D5\\u05D3 \\u05E9\\u05D2\\u05D9\\u05D0\\u05D4: \", ctx_r3.payment.creditResponse, \" \");\n  }\n}\n\nfunction UohPayFailureComponent_ng_container_0_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementContainerStart(0);\n    ɵngcc0.ɵɵelementStart(1, \"div\", 2);\n    ɵngcc0.ɵɵelementStart(2, \"b\");\n    ɵngcc0.ɵɵtext(3, \"\\u05D4\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD \\u05E0\\u05DB\\u05E9\\u05DC.\");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵtemplate(4, UohPayFailureComponent_ng_container_0_div_4_Template, 2, 1, \"div\", 3);\n    ɵngcc0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(4);\n    ɵngcc0.ɵɵproperty(\"ngIf\", ctx_r0.payment.creditResponse);\n  }\n}\n\nfunction UohPayFailureComponent_ng_template_1_ng_container_9_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementContainerStart(0);\n    ɵngcc0.ɵɵelementStart(1, \"div\", 2);\n    ɵngcc0.ɵɵtext(2, \" \\u05E7\\u05D5\\u05D3 \\u05D4\\u05E9\\u05D2\\u05D9\\u05D0\\u05D4: \");\n    ɵngcc0.ɵɵelementStart(3, \"span\");\n    ɵngcc0.ɵɵtext(4);\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementStart(5, \"div\", 6);\n    ɵngcc0.ɵɵelement(6, \"uoh-pay-failure-contact\", 7);\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = ɵngcc0.ɵɵnextContext(2);\n    ɵngcc0.ɵɵadvance(4);\n    ɵngcc0.ɵɵtextInterpolate1(\"\", ctx_r4.token, \".\");\n    ɵngcc0.ɵɵadvance(2);\n    ɵngcc0.ɵɵproperty(\"email\", ctx_r4.contact.email)(\"subject\", \"\\u05E9\\u05D2\\u05D9\\u05D0\\u05D4 \\u05D1\\u05E9\\u05DC\\u05D9\\u05E4\\u05EA \\u05E4\\u05E8\\u05D8\\u05D9 \\u05EA\\u05E9\\u05DC\\u05D5\\u05DD - \\u05E7\\u05D5\\u05D3 \\u05E9\\u05D2\\u05D9\\u05D0\\u05D4: \" + ctx_r4.token)(\"body\", \"\\u05DC\\u05D0 \\u05E0\\u05D9\\u05EA\\u05DF \\u05DC\\u05E9\\u05DC\\u05D5\\u05E3 \\u05D0\\u05EA \\u05E4\\u05E8\\u05D8\\u05D9 \\u05D4\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD - \\u05E7\\u05D5\\u05D3 \\u05E9\\u05D2\\u05D9\\u05D0\\u05D4: \" + ctx_r4.token);\n  }\n}\n\nfunction UohPayFailureComponent_ng_template_1_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"div\", 2);\n    ɵngcc0.ɵɵelementStart(1, \"div\");\n    ɵngcc0.ɵɵelementStart(2, \"b\");\n    ɵngcc0.ɵɵtext(3, \"\\u05DC\\u05D0 \\u05E0\\u05D9\\u05EA\\u05DF \\u05DC\\u05E9\\u05DC\\u05D5\\u05E3 \\u05D0\\u05EA \\u05E4\\u05E8\\u05D8\\u05D9 \\u05D4\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD.\");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementStart(4, \"div\");\n    ɵngcc0.ɵɵtext(5, \" \\u05E0\\u05D0 \\u05DC\\u05E4\\u05E0\\u05D5\\u05EA \\u05D0\\u05DC \");\n    ɵngcc0.ɵɵelementStart(6, \"a\", 4);\n    ɵngcc0.ɵɵtext(7);\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵtext(8, \". \");\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵtemplate(9, UohPayFailureComponent_ng_template_1_ng_container_9_Template, 7, 4, \"ng-container\", 5);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(6);\n    ɵngcc0.ɵɵproperty(\"href\", ctx_r2.contact.website, ɵngcc0.ɵɵsanitizeUrl);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate(ctx_r2.contact.name);\n    ɵngcc0.ɵɵadvance(2);\n    ɵngcc0.ɵɵproperty(\"ngIf\", ctx_r2.token);\n  }\n}\n\nconst UOH_PAY_CONFIG = new InjectionToken('The resolved configuration for the UOH payment service.');\n/**\r\n * The codes for the currencies in the 3rd party payment supplier (Tranzila).\r\n */\n\nvar UohPayCurrency = /*#__PURE__*/(() => {\n  (function (UohPayCurrency) {\n    UohPayCurrency[\"ILS\"] = \"ILS\";\n    UohPayCurrency[\"USD\"] = \"USD\";\n    UohPayCurrency[\"EUR\"] = \"EUR\";\n    UohPayCurrency[\"GBP\"] = \"GBP\";\n  })(UohPayCurrency || (UohPayCurrency = {}));\n\n  return UohPayCurrency;\n})();\nconst UOH_PAY_CURRENCY_ID = {\n  ILS: 1,\n  USD: 2,\n  EUR: 978,\n  GBP: 826\n};\n/**\r\n * The codes for the languages in the 3rd party payment supplier (Tranzila).\r\n */\n\nvar UohPayLanguage = /*#__PURE__*/(() => {\n  (function (UohPayLanguage) {\n    UohPayLanguage[\"Hebrew\"] = \"il\";\n    UohPayLanguage[\"English\"] = \"us\";\n    UohPayLanguage[\"Rusian\"] = \"ru\";\n    UohPayLanguage[\"Spanish\"] = \"es\";\n    UohPayLanguage[\"German\"] = \"de\";\n    UohPayLanguage[\"French\"] = \"fr\";\n    UohPayLanguage[\"Japanese\"] = \"jp\";\n  })(UohPayLanguage || (UohPayLanguage = {}));\n\n  return UohPayLanguage;\n})();\n\n/**\r\n * The status for the payment retrieved from the api.\r\n */\nvar UohPayStatus = /*#__PURE__*/(() => {\n  (function (UohPayStatus) {\n    UohPayStatus[\"Pending\"] = \"pending\";\n    UohPayStatus[\"Success\"] = \"success\";\n    UohPayStatus[\"Failure\"] = \"failure\";\n  })(UohPayStatus || (UohPayStatus = {}));\n\n  return UohPayStatus;\n})();\nconst UOH_PAY_DEFAULT_THEME = {\n  name: 'default',\n  button: '0664aa',\n  text: '333333',\n  background: 'ffffff'\n};\nconst UOH_PAY_DARK_THEME = {\n  name: 'dark',\n  button: '0664aa',\n  text: 'ffffff',\n  background: '424242'\n};\n/**\r\n * The payment type as represented by the api.\r\n */\n\nvar UohPayType = /*#__PURE__*/(() => {\n  (function (UohPayType) {\n    /**\r\n     * A single payment.\r\n     */\n    UohPayType[\"Single\"] = \"single\";\n    /**\r\n     * Installments charged as credit (generally, the number of credit installments is greater than the regular installments).\r\n     */\n\n    UohPayType[\"Credit\"] = \"credit\";\n    /**\r\n     * Regular installments (a sum divided into multiple payments).\r\n     */\n\n    UohPayType[\"Installments\"] = \"installments\";\n  })(UohPayType || (UohPayType = {}));\n\n  return UohPayType;\n})();\n\n/**\r\n * The payment type (or cred_type in Tranzila).\r\n */\nconst UOH_PAY_TYPE_ID = {\n  single: 1,\n  credit: 6,\n  installments: 8\n}; // TODO: Move the labels to i18n.\n\nconst UOH_PAY_TYPE_NAME_HE = {\n  single: 'תשלום בודד',\n  credit: 'תשלומים בקרדיט',\n  installments: 'תשלומים'\n};\nconst UOH_PAY_CONTACT = new InjectionToken('The contact details in case of error');\n/**\r\n * Retrieves the payment details from the payment API.\r\n */\n\nlet UohPay = /*#__PURE__*/(() => {\n  class UohPay {\n    constructor(httpBackend, logger, config) {\n      this.httpBackend = httpBackend;\n      this.logger = logger;\n      this.config = config;\n      this.store = new UohStore({\n        status: UohPayStatus.Pending\n      }, 'uoh-payment'); // The following headers prevent browser caching (specially for IE11).\n\n      this.HEADERS = new HttpHeaders().set('Cache-Control', 'no-cache').set('Pragma', 'no-cache').set('Expires', 'Thu, 01 Jan 1970 00:00:00 GMT').set('If-Modified-Since', '0');\n      this.payment$ = this.store.state$;\n      this.http = new HttpClient(httpBackend);\n    }\n\n    get payment() {\n      return this.store.getState();\n    }\n    /**\r\n     * Checks if a message event that comes from the payment service (iframe).\r\n     * @param event The message event.\r\n     */\n\n\n    isMessageValid(event) {\n      this.logger.debug('[UohPay.isMessageValid] Event origin:', event.origin, 'config.origin:', this.config.origin);\n      return event.origin === this.config.origin;\n    }\n    /**\r\n     * Retrieves the payment status from the message event that comes from the payment service (iframe).\r\n     * For a secure implementation, use only after the isMessageValid method returned true.\r\n     * @param event The message event.\r\n     */\n\n\n    getMessageStatus(event) {\n      try {\n        if (event.data.toLowerCase() === UohPayStatus.Success.toLowerCase()) {\n          return UohPayStatus.Success;\n        } else if (event.data.toLowerCase() === UohPayStatus.Failure.toLowerCase()) {\n          return UohPayStatus.Failure;\n        }\n      } catch (e) {}\n\n      return UohPayStatus.Pending;\n    }\n    /**\r\n     * Retrieves the payment details associated with the token when the payment is complete (either success or failure).\r\n     * It retries in case of errors or a pending payment until the maximum number of trials (see UohPayOptions) is reached.\r\n     * @param token The payment token.\r\n     */\n\n\n    onComplete(token) {\n      try {\n        // Tries to retrieve the payment details until it is no longer pending.\n        return this.get(token).pipe(map(payment => {\n          if (payment.status === UohPayStatus.Pending) {\n            throw UohPayStatus.Pending;\n          }\n\n          return payment;\n        }), retryWhen(errors => this.retryStrategy(errors, this.config.retryScale, this.config.maxAttempts)));\n      } catch (e) {\n        const message = this.getErrorMessage(e);\n        throwError(`[UohPay.onComplete] For token: ${token} error message ${message}`);\n      }\n    }\n    /**\r\n     * Retrieves the payment details associated with the token.\r\n     * @param token The payment token.\r\n     */\n\n\n    get(token) {\n      try {\n        const url = `${this.config.api}/status/${token}`;\n        return this.http.get(url, {\n          headers: this.HEADERS\n        }).pipe(tap(payment => {\n          if (this.config.overrideState === true) {\n            this.store.overrideState(payment);\n          } else {\n            this.store.setState(payment);\n          }\n        }), catchError(error => {\n          const message = this.getErrorMessage(error);\n          return throwError(message);\n        }));\n      } catch (e) {\n        const message = this.getErrorMessage(e);\n        throwError(`[UohPay.get] For token: ${token} error message: ${message}`);\n      }\n    }\n    /**\r\n     * Resets the stored payment process.\r\n     */\n\n\n    reset() {\n      this.store.reset();\n    }\n    /**\r\n     * Generates a strategy to retry to reach the API.\r\n     * @param errors The errors from the retryWhen pipe.\r\n     * @param scale The scale of time (in ms) to calculate the delay (scale * number of attempt) between retries.\r\n     * @param maxAttempts The maximum number of attempts.\r\n     */\n\n\n    retryStrategy(errors, scale, maxAttempts) {\n      return errors.pipe( // Merge the errors to assign them a index and count them.\n      mergeMap((error, index) => {\n        const attempt = index + 1;\n        const delay = scale + attempt;\n        this.logger.error(`[UohPay.retryStrategy] Attempt ${attempt}: ${error} retry in ${delay} ms`); // Throw a final error after a number of unsuccessful retries.\n\n        if (attempt > maxAttempts) {\n          return throwError(`[UohPay.retryStrategy] The maximum number of attempts (${maxAttempts}) was reached: ${error}`);\n        }\n\n        return timer(delay);\n      }));\n    }\n    /**\r\n     * Returns the error message according to the error type.\r\n     * @param error The error.\r\n     */\n\n\n    getErrorMessage(error) {\n      try {\n        if (error instanceof ErrorEvent) {\n          // Javascript client-side error during HTTP request.\n          return !!error.error ? error.error.message : 'ErrorEvent without message';\n        } else if (error instanceof HttpErrorResponse) {\n          // Backend error.\n          return `HttpErrorResponse with status: ${error.status}, message: ${error.message}, body: ${error.error}`;\n        } else {\n          // Any error.\n          return `Error name: ${error.name}, message: ${error.message}, stack: ${error.stack}`;\n        }\n      } catch (e) {\n        return 'No message';\n      }\n    }\n\n  }\n\n  UohPay.ɵfac = function UohPay_Factory(t) {\n    return new (t || UohPay)(ɵngcc0.ɵɵinject(ɵngcc1.HttpBackend), ɵngcc0.ɵɵinject(ɵngcc2.UohLogger), ɵngcc0.ɵɵinject(UOH_PAY_CONFIG));\n  };\n\n  UohPay.ɵprov = /*@__PURE__*/ɵngcc0.ɵɵdefineInjectable({\n    token: UohPay,\n    factory: UohPay.ɵfac\n  });\n  return UohPay;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\nconst UOH_PAY_DEFAULT_API = {\n  development: 'https://paymentsdev.haifa.ac.il/paymentService/api',\n  qa: 'https://paymentsqa.haifa.ac.il/paymentService/api',\n  production: 'https://payments.haifa.ac.il/paymentService/api'\n};\nconst UOH_TERMINAL_PLACEHOLDER = '{terminal}';\nconst UOH_PAY_DEFAULT_OPTIONS = {\n  api: UOH_PAY_DEFAULT_API,\n  retryScale: 1000,\n  maxAttempts: 10,\n  url: `https://direct.tranzila.com/${UOH_TERMINAL_PLACEHOLDER}/iframenew.php`,\n  overrideState: false\n};\nconst UOH_PAY_DEFAULT_CONTACT = {\n  name: 'מרכז שירות ותמיכה',\n  email: 'helpdesk@univ.haifa.ac.il',\n  website: 'https://stud-hc.haifa.ac.il/he'\n};\nconst UOH_PAY_OPTIONS = new InjectionToken('User options for the UOH payment service.');\n/**\r\n * Adds and overrides UohPay methods to assure functionality on local development.\r\n */\n\nlet UohPayMock = /*#__PURE__*/(() => {\n  class UohPayMock extends UohPay {\n    constructor(httpBackend, logger, config) {\n      super(httpBackend, logger, config);\n      this.ORIGIN = 'http://localhost:4200';\n    }\n    /**\r\n     * Mocks the postMessage mechanism by sending a message to this window.\r\n     */\n\n\n    mock() {\n      const message = UohPayStatus.Pending;\n      window.postMessage(message, this.ORIGIN);\n    }\n    /**\r\n     * Mocks the validation of the postMessage event.\r\n     * @param event The message event.\r\n     */\n\n\n    isMessageValid(event) {\n      return true;\n    }\n\n  }\n\n  UohPayMock.ɵfac = function UohPayMock_Factory(t) {\n    return new (t || UohPayMock)(ɵngcc0.ɵɵinject(ɵngcc1.HttpBackend), ɵngcc0.ɵɵinject(ɵngcc2.UohLogger), ɵngcc0.ɵɵinject(undefined));\n  };\n\n  UohPayMock.ɵprov = /*@__PURE__*/ɵngcc0.ɵɵdefineInjectable({\n    token: UohPayMock,\n    factory: UohPayMock.ɵfac\n  });\n  return UohPayMock;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n/**\r\n * This file contains a set of functions to be used internally (not exposed to the users of this package).\r\n */\n\n/**\r\n * Returns the origin from the url, i.e.: 'https://payment.haifa.ac.il' from 'https://payment.haifa.ac.il/paymentService'.\r\n * @param input The payment url.\r\n */\n\n\nfunction getOrigin(input) {\n  try {\n    // Try to convert the string input into an URL and return its origin.\n    const url = new URL(input);\n    return url.origin;\n  } catch (e) {\n    // If it fails, fallback to get a slice of the string.\n    // Retrieve the position of the first slash that is not followed by another slash.\n    const doubleSlash = input.indexOf('//');\n    const firstSlash = doubleSlash > -1 ? input.indexOf('/', doubleSlash + 2) : input.indexOf('/');\n    return firstSlash > -1 ? input.substring(0, firstSlash) : input;\n  }\n}\n/**\r\n * Returns the api url that corresponds to the running environment.\r\n * @param environment The environment the application is running on (dev, qa or prod).\r\n * @param api The object containing a different api url for each environment.\r\n */\n\n\nfunction getEnvironmentApi(environment, api) {\n  if (environment === UohEnvironment.Development) {\n    return api.development;\n  } else if (environment === UohEnvironment.QA) {\n    return api.qa;\n  } else {\n    return api.production;\n  }\n}\n/**\r\n * Returns the payment api url that corresponds the running environment.\r\n * @param environment The environment the application is running on.\r\n * @param options The payment options entered by the user.\r\n */\n\n\nfunction resolvePaymentApi(environment, options) {\n  if (!!options && !!options.api) {\n    return typeof options.api === 'string' ? options.api : getEnvironmentApi(environment, options.api);\n  }\n\n  return getEnvironmentApi(environment, UOH_PAY_DEFAULT_OPTIONS.api);\n}\n/**\r\n * Returns the configuration for the payment service.\r\n * @param environment The environment the application is running on.\r\n * @param options The payment options entered by the user.\r\n */\n\n\nfunction resolvePaymentConfig(environment, options) {\n  const api = resolvePaymentApi(environment, options);\n  const origin = getOrigin(api);\n\n  if (!!options && !!options.url && !options.url.includes(UOH_TERMINAL_PLACEHOLDER)) {\n    throw new Error(`The terminal url should include the following pattern ${UOH_TERMINAL_PLACEHOLDER}`);\n  }\n\n  return Object.assign(Object.assign({\n    retryScale: UOH_PAY_DEFAULT_OPTIONS.retryScale,\n    maxAttempts: UOH_PAY_DEFAULT_OPTIONS.maxAttempts,\n    url: UOH_PAY_DEFAULT_OPTIONS.url,\n    placeholder: UOH_TERMINAL_PLACEHOLDER,\n    overrideState: false\n  }, options), {\n    api,\n    origin\n  });\n}\n/**\r\n * A provider factory that returns the PaymentService instance.\r\n * @param httpBackend The Angular HttpBackend service.\r\n * @param logger The UOH logger to log the details.\r\n * @param config The configuration for the payment service.\r\n */\n\n\nfunction resolvePaymentService(httpBackend, logger, config) {\n  return new UohPay(httpBackend, logger, config);\n}\n/**\r\n * A provider factory that returns the PaymentService instance.\r\n * @param httpBackend The Angular HttpBackend service.\r\n * @param logger The UOH logger to log the details.\r\n * @param config The configuration for the payment service.\r\n */\n\n\nfunction resolveMockService(httpBackend, logger, config) {\n  return new UohPayMock(httpBackend, logger, config);\n}\n\nlet UohPayModule = /*#__PURE__*/(() => {\n  class UohPayModule {\n    constructor(parentModule) {\n      if (!!parentModule) {\n        throw new Error('UohPayModule is already loaded. Import it in the AppModule only.');\n      }\n    }\n    /**\r\n     * Configures a new UohPayModule using the given options.\r\n     * @param options The options for the UohPay service.\r\n     */\n\n\n    static forRoot(options = UOH_PAY_DEFAULT_OPTIONS) {\n      return {\n        ngModule: UohPayModule,\n        providers: [{\n          provide: UOH_PAY_OPTIONS,\n          useValue: options\n        }, {\n          provide: UOH_PAY_CONFIG,\n          useFactory: resolvePaymentConfig,\n          deps: [UOH_ENVIRONMENT, UOH_PAY_OPTIONS]\n        }, {\n          provide: UohPay,\n          useFactory: resolvePaymentService,\n          deps: [HttpBackend, UohLogger, UOH_PAY_CONFIG]\n        }]\n      };\n    }\n\n  }\n\n  UohPayModule.ɵfac = function UohPayModule_Factory(t) {\n    return new (t || UohPayModule)(ɵngcc0.ɵɵinject(UohPayModule, 12));\n  };\n\n  UohPayModule.ɵmod = /*@__PURE__*/ɵngcc0.ɵɵdefineNgModule({\n    type: UohPayModule\n  });\n  UohPayModule.ɵinj = /*@__PURE__*/ɵngcc0.ɵɵdefineInjector({\n    imports: [[CommonModule, HttpClientModule, UohEnvironmentModule]]\n  });\n  return UohPayModule;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(UohPayModule, {\n    imports: function () {\n      return [CommonModule, HttpClientModule, UohEnvironmentModule];\n    }\n  });\n})();\n/**\r\n * A mock module for local development.\r\n */\n\n\nlet UohPayMockModule = /*#__PURE__*/(() => {\n  class UohPayMockModule {\n    constructor(parentModule) {\n      if (!!parentModule) {\n        throw new Error('UohPayMockModule is already loaded. Import it in the AppModule only.');\n      }\n\n      if (!document.URL.includes('localhost')) {\n        console.warn('The UohPayMockModule should be used for local development (localhost) only.');\n      }\n    }\n    /**\r\n     * Configures a new UohPayMockModule using the given options.\r\n     * Use this module for local development only.\r\n     * @param options The options for the UohPay service.\r\n     */\n\n\n    static forRoot(options = UOH_PAY_DEFAULT_OPTIONS) {\n      return {\n        ngModule: UohPayMockModule,\n        providers: [{\n          provide: UOH_PAY_OPTIONS,\n          useValue: options\n        }, {\n          provide: UOH_PAY_CONFIG,\n          useFactory: resolvePaymentConfig,\n          deps: [UOH_ENVIRONMENT, UOH_PAY_OPTIONS]\n        }, {\n          provide: UohPay,\n          useFactory: resolveMockService,\n          deps: [HttpBackend, UohLogger, UOH_PAY_CONFIG]\n        }]\n      };\n    }\n\n  }\n\n  UohPayMockModule.ɵfac = function UohPayMockModule_Factory(t) {\n    return new (t || UohPayMockModule)(ɵngcc0.ɵɵinject(UohPayMockModule, 12));\n  };\n\n  UohPayMockModule.ɵmod = /*@__PURE__*/ɵngcc0.ɵɵdefineNgModule({\n    type: UohPayMockModule\n  });\n  UohPayMockModule.ɵinj = /*@__PURE__*/ɵngcc0.ɵɵdefineInjector({\n    imports: [[CommonModule, HttpClientModule, UohEnvironmentModule]]\n  });\n  return UohPayMockModule;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(UohPayMockModule, {\n    imports: function () {\n      return [CommonModule, HttpClientModule, UohEnvironmentModule];\n    }\n  });\n})();\n/**\r\n * This service handles acts as a proxy between the deactivation guard and the payment page component.\r\n */\n\n\nlet UohPayDeactivate = /*#__PURE__*/(() => {\n  class UohPayDeactivate {\n    constructor() {\n      /**\r\n       * Represents a deactivation request sent by the guard.\r\n       */\n      this.request = new Subject();\n      /**\r\n       * Represents a deactivation response sent by the uoh-pay-page component.\r\n       */\n\n      this.response = new BehaviorSubject(undefined);\n      /**\r\n       * Whether this service should be active. That is, should check the deactivation.\r\n       * This property should be false if the uoh-pay-page is not present on screen.\r\n       */\n\n      this.active = false;\n    }\n    /**\r\n     * Initializes this service - check if the uoh-pay-page can be deactivated.\r\n     */\n\n\n    init() {\n      this.active = true;\n      return this.request.asObservable();\n    }\n    /**\r\n     * Destroys this service - the uoh-pay-page is no longer present on screen.\r\n     */\n\n\n    destroy() {\n      this.active = false;\n    }\n    /**\r\n     * This method will be called by the guard, when a request to deactivate the component is emitted.\r\n     * It will fire when the response is set.\r\n     */\n\n\n    sendRequest() {\n      // Continue only if this service is active.\n      if (!this.active) {\n        return of(true);\n      } // Reset the response. Thus, the guard will wait for a new one.\n\n\n      this.response.next(undefined);\n      this.request.next();\n      return this.response.asObservable().pipe(filter(deactivate => deactivate !== undefined && deactivate !== null));\n    }\n    /**\r\n     * This method will be called by the component, when it decides whether it can be deactivated or not.\r\n     * @param deactivate True if the guard can deactivate the component, false otherwise.\r\n     */\n\n\n    sendResponse(deactivate) {\n      this.response.next(deactivate);\n    }\n\n  }\n\n  UohPayDeactivate.ɵfac = function UohPayDeactivate_Factory(t) {\n    return new (t || UohPayDeactivate)();\n  };\n\n  UohPayDeactivate.ɵprov = ɵɵdefineInjectable({\n    factory: function UohPayDeactivate_Factory() {\n      return new UohPayDeactivate();\n    },\n    token: UohPayDeactivate,\n    providedIn: \"root\"\n  });\n  return UohPayDeactivate;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n/**\r\n * Transfers the authority to deactivate the T component to the UohPayPageComponent.\r\n */\n\n\nlet UohPayDeactivateGuard = /*#__PURE__*/(() => {\n  class UohPayDeactivateGuard {\n    constructor(deactivate) {\n      this.deactivate = deactivate;\n    }\n    /**\r\n     * Checks if a component that implements the deactivable interface can be deactivated.\r\n     * @param component The deactivable component.\r\n     * @param currentRoute The current route.\r\n     * @param currentState The current router state.\r\n     * @param nextState The next router state.\r\n     */\n\n\n    canDeactivate(component, currentRoute, currentState, nextState) {\n      // Send a deactivation request to the page component using the service.\n      // The deactivation logic resides in the page component itself.\n      // Return the response emitted by the page.\n      return this.deactivate.sendRequest();\n    }\n\n  }\n\n  UohPayDeactivateGuard.ɵfac = function UohPayDeactivateGuard_Factory(t) {\n    return new (t || UohPayDeactivateGuard)(ɵngcc0.ɵɵinject(UohPayDeactivate));\n  };\n\n  UohPayDeactivateGuard.ɵprov = ɵɵdefineInjectable({\n    factory: function UohPayDeactivateGuard_Factory() {\n      return new UohPayDeactivateGuard(ɵɵinject(UohPayDeactivate));\n    },\n    token: UohPayDeactivateGuard,\n    providedIn: \"root\"\n  });\n  return UohPayDeactivateGuard;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n/**\r\n * Generates the url for the payment page.\r\n */\n\n\nlet UohPayUrlBuilder = /*#__PURE__*/(() => {\n  class UohPayUrlBuilder {\n    constructor(config) {\n      this.config = config;\n    }\n    /**\r\n     * Builds the url for the payment page.\r\n     * @param terminal The terminal where to execute the payment.\r\n     * @param params The basic parameters to send to the terminal.\r\n     * @param customParams Custom parameters to sent to the terminal.\r\n     */\n\n\n    build(terminal, params, customParams) {\n      // Get the base url for the payment page by setting the terminal name in the config url.\n      const url = this.config.url.replace(this.config.placeholder, terminal);\n      let mappedParams = this.mapParams(params); // Merge and override the basic params with the custom ones.\n      // If one of the custom params contains the same key as a mapped basic param, the custom one will prevail.\n\n      for (const key of customParams.keys()) {\n        const value = customParams.get(key);\n        mappedParams = mappedParams.set(key, value);\n      }\n\n      return this.endsWithQuestionMark(url) ? `${url}${mappedParams}` : `${url}?${mappedParams}`;\n    }\n    /**\r\n     * Maps the params for the payment page into a HTTP params object.\r\n     * @param params The params for the payment page.\r\n     */\n\n\n    mapParams(params) {\n      const currency = this.getCurrency(params.currency);\n      const type = this.getType(params.type);\n      const theme = params.theme ? params.theme : this.getTheme();\n      let result = new HttpParams().set('lang', params.language ? params.language : UohPayLanguage.Hebrew).set('currency', currency.toString()).set('pdesc', params.product.description).set('sum', params.sum.toString()).set('TranzilaToken', params.token).set('uohToken', params.token).set('contact', `${params.customer.firstName} ${params.customer.lastName}`).set('fname', params.customer.firstName).set('lname', params.customer.lastName).set('myid', params.customer.id).set('studentid', params.customer.id).set('email', params.customer.email).set('DCdisable', params.product.code).set('cred_type', type.toString()); // Add the maxpay parameter is not a single payment.\n\n      if (!!params.type && params.type !== UohPayType.Single) {\n        const maxInstallments = this.getMaxInstallments(params.maxInstallments);\n        result = result.set('maxpay', maxInstallments.toString());\n      } // Finally, add the theme parameters.\n\n\n      result = result.set('trButtonColor', theme.button).set('trBgColor', theme.background).set('trTextColor', theme.text).set('theme', theme.name);\n      return result;\n    }\n\n    getCurrency(currency) {\n      return UOH_PAY_CURRENCY_ID[!!currency ? currency : UohPayCurrency.ILS];\n    }\n    /**\r\n     * Retrieves the payment type. If undefined, returns the single payment type.\r\n     * @param type The payment type.\r\n     */\n\n\n    getType(type) {\n      return UOH_PAY_TYPE_ID[!!type ? type : UohPayType.Single];\n    }\n    /**\r\n     * Retrieves the maximum number of installments. If undefined, returns 1.\r\n     * @param maxInstallments The maximum number of installments.\r\n     */\n\n\n    getMaxInstallments(maxInstallments) {\n      return !!maxInstallments ? maxInstallments : 1;\n    }\n    /**\r\n     * Retrieves the theme for the payment page.\r\n     */\n\n\n    getTheme() {\n      return this.isDarkTheme() ? UOH_PAY_DARK_THEME : UOH_PAY_DEFAULT_THEME;\n    }\n    /**\r\n     * Checks if the selected theme is the dark-theme.\r\n     */\n\n\n    isDarkTheme() {\n      // TODO: Use a uoh theme service to get the theme mode (in future versions).\n      try {\n        const theme = localStorage.getItem('theme');\n        return theme === 'dark-theme';\n      } catch (e) {}\n\n      return false;\n    }\n    /**\r\n     * Returns true if an url ends with a question mark, false otherwise.\r\n     * @param url The url.\r\n     */\n\n\n    endsWithQuestionMark(url) {\n      const lastChar = url.substring(url.length - 1, url.length);\n      return lastChar === '?';\n    }\n\n  }\n\n  UohPayUrlBuilder.ɵfac = function UohPayUrlBuilder_Factory(t) {\n    return new (t || UohPayUrlBuilder)(ɵngcc0.ɵɵinject(UOH_PAY_CONFIG));\n  };\n\n  UohPayUrlBuilder.ɵprov = ɵɵdefineInjectable({\n    factory: function UohPayUrlBuilder_Factory() {\n      return new UohPayUrlBuilder(ɵɵinject(UOH_PAY_CONFIG));\n    },\n    token: UohPayUrlBuilder,\n    providedIn: \"root\"\n  });\n  return UohPayUrlBuilder;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\nlet UohPayCloseDialogComponent = /*#__PURE__*/(() => {\n  class UohPayCloseDialogComponent {\n    constructor() {}\n\n    ngOnInit() {}\n\n  }\n\n  UohPayCloseDialogComponent.ɵfac = function UohPayCloseDialogComponent_Factory(t) {\n    return new (t || UohPayCloseDialogComponent)();\n  };\n\n  UohPayCloseDialogComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: UohPayCloseDialogComponent,\n    selectors: [[\"uoh-pay-close-dialog\"]],\n    decls: 13,\n    vars: 2,\n    consts: [[\"mat-dialog-courses\", \"\"], [\"mat-dialog-content\", \"\"], [\"mat-dialog-actions\", \"\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"cdkFocusInitial\", \"\", 3, \"mat-dialog-close\"], [\"mat-raised-button\", \"\", 3, \"mat-dialog-close\"]],\n    template: function UohPayCloseDialogComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵelementStart(0, \"h3\", 0);\n        ɵngcc0.ɵɵelementStart(1, \"mat-icon\");\n        ɵngcc0.ɵɵtext(2, \"warning\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(3, \"span\");\n        ɵngcc0.ɵɵtext(4, \" \\u05DC\\u05EA\\u05E9\\u05D5\\u05DE\\u05EA \\u05DC\\u05D1\\u05DA \");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(5, \"div\", 1);\n        ɵngcc0.ɵɵelementStart(6, \"div\");\n        ɵngcc0.ɵɵtext(7, \"\\u05D4\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD \\u05D8\\u05E8\\u05DD \\u05D4\\u05E1\\u05EA\\u05D9\\u05D9\\u05DD.\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(8, \"div\", 2);\n        ɵngcc0.ɵɵelementStart(9, \"button\", 3);\n        ɵngcc0.ɵɵtext(10, \"\\u05D7\\u05D6\\u05E8\\u05D4 \\u05DC\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(11, \"button\", 4);\n        ɵngcc0.ɵɵtext(12, \"\\u05D9\\u05E6\\u05D9\\u05D0\\u05D4\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        ɵngcc0.ɵɵadvance(9);\n        ɵngcc0.ɵɵproperty(\"mat-dialog-close\", false);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"mat-dialog-close\", true);\n      }\n    },\n    directives: [ɵngcc3.MatDialogcourse, ɵngcc4.MatIcon, ɵngcc3.MatDialogContent, ɵngcc3.MatDialogActions, ɵngcc5.MatButton, ɵngcc3.MatDialogClose],\n    styles: [_c0]\n  });\n  return UohPayCloseDialogComponent;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\nlet UohPaySlowConnectionDialogComponent = /*#__PURE__*/(() => {\n  class UohPaySlowConnectionDialogComponent {\n    constructor() {}\n\n    ngOnInit() {}\n\n  }\n\n  UohPaySlowConnectionDialogComponent.ɵfac = function UohPaySlowConnectionDialogComponent_Factory(t) {\n    return new (t || UohPaySlowConnectionDialogComponent)();\n  };\n\n  UohPaySlowConnectionDialogComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: UohPaySlowConnectionDialogComponent,\n    selectors: [[\"uoh-pay-slow-connection-dialog\"]],\n    decls: 13,\n    vars: 1,\n    consts: [[\"mat-dialog-courses\", \"\"], [\"mat-dialog-content\", \"\"], [\"mat-dialog-actions\", \"\"], [\"mat-raised-button\", \"\", \"cdkFocusInitial\", \"\", 3, \"mat-dialog-close\"]],\n    template: function UohPaySlowConnectionDialogComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵelementStart(0, \"h3\", 0);\n        ɵngcc0.ɵɵelementStart(1, \"mat-icon\");\n        ɵngcc0.ɵɵtext(2, \"warning\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(3, \"span\");\n        ɵngcc0.ɵɵtext(4, \" \\u05DC\\u05EA\\u05E9\\u05D5\\u05DE\\u05EA \\u05DC\\u05D1\\u05DA \");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(5, \"div\", 1);\n        ɵngcc0.ɵɵelementStart(6, \"div\");\n        ɵngcc0.ɵɵtext(7, \"\\u05D4\\u05EA\\u05E7\\u05E9\\u05D5\\u05E8\\u05EA \\u05DE\\u05D5\\u05DC \\u05E9\\u05D9\\u05E8\\u05D5\\u05EA \\u05D4\\u05EA\\u05E9\\u05DC\\u05D5\\u05DE\\u05D9\\u05DD \\u05D0\\u05D9\\u05D8\\u05D9\\u05EA.\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(8, \"div\");\n        ɵngcc0.ɵɵtext(9, \"\\u05E0\\u05D0 \\u05DC\\u05D4\\u05DE\\u05EA\\u05D9\\u05DF \\u05D0\\u05D5 \\u05DC\\u05E0\\u05E1\\u05D5\\u05EA \\u05E9\\u05D5\\u05D1 \\u05DE\\u05D0\\u05D5\\u05D7\\u05E8 \\u05D9\\u05D5\\u05EA\\u05E8.\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(10, \"div\", 2);\n        ɵngcc0.ɵɵelementStart(11, \"button\", 3);\n        ɵngcc0.ɵɵtext(12, \"\\u05D0\\u05D9\\u05E9\\u05D5\\u05E8\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        ɵngcc0.ɵɵadvance(11);\n        ɵngcc0.ɵɵproperty(\"mat-dialog-close\", true);\n      }\n    },\n    directives: [ɵngcc3.MatDialogcourse, ɵngcc4.MatIcon, ɵngcc3.MatDialogContent, ɵngcc3.MatDialogActions, ɵngcc5.MatButton, ɵngcc3.MatDialogClose],\n    styles: [_c0]\n  });\n  return UohPaySlowConnectionDialogComponent;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\nlet UohPayUnreachableDialogComponent = /*#__PURE__*/(() => {\n  class UohPayUnreachableDialogComponent {\n    constructor(contact) {\n      this.contact = contact;\n    }\n\n    ngOnInit() {}\n\n  }\n\n  UohPayUnreachableDialogComponent.ɵfac = function UohPayUnreachableDialogComponent_Factory(t) {\n    return new (t || UohPayUnreachableDialogComponent)(ɵngcc0.ɵɵdirectiveInject(UOH_PAY_CONTACT));\n  };\n\n  UohPayUnreachableDialogComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: UohPayUnreachableDialogComponent,\n    selectors: [[\"uoh-pay-unreachable-dialog\"]],\n    decls: 18,\n    vars: 4,\n    consts: [[\"mat-dialog-courses\", \"\"], [\"mat-dialog-content\", \"\"], [\"target\", \"_blank\", 3, \"href\"], [\"mat-dialog-actions\", \"\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"cdkFocusInitial\", \"\", 3, \"mat-dialog-close\"], [\"mat-raised-button\", \"\", 3, \"mat-dialog-close\"]],\n    template: function UohPayUnreachableDialogComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵelementStart(0, \"h3\", 0);\n        ɵngcc0.ɵɵelementStart(1, \"mat-icon\");\n        ɵngcc0.ɵɵtext(2, \"error\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(3, \"span\");\n        ɵngcc0.ɵɵtext(4, \" \\u05DC\\u05EA\\u05E9\\u05D5\\u05DE\\u05EA \\u05DC\\u05D1\\u05DA \");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(5, \"div\", 1);\n        ɵngcc0.ɵɵelementStart(6, \"div\");\n        ɵngcc0.ɵɵtext(7, \"\\u05DC\\u05D0 \\u05E0\\u05D9\\u05EA\\u05DF \\u05DC\\u05D9\\u05E6\\u05D5\\u05E8 \\u05E7\\u05E9\\u05E8 \\u05DE\\u05D5\\u05DC \\u05E9\\u05D9\\u05E8\\u05D5\\u05EA \\u05D4\\u05EA\\u05E9\\u05DC\\u05D5\\u05DE\\u05D9\\u05DD.\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(8, \"div\");\n        ɵngcc0.ɵɵtext(9, \" \\u05D0\\u05DD \\u05D4\\u05D1\\u05E2\\u05D9\\u05D4 \\u05E0\\u05DE\\u05E9\\u05DB\\u05EA \\u05E0\\u05D0 \\u05DC\\u05E4\\u05E0\\u05D5\\u05EA \\u05D0\\u05DC \");\n        ɵngcc0.ɵɵelementStart(10, \"a\", 2);\n        ɵngcc0.ɵɵtext(11);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtext(12, \". \");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(13, \"div\", 3);\n        ɵngcc0.ɵɵelementStart(14, \"button\", 4);\n        ɵngcc0.ɵɵtext(15, \"\\u05DC\\u05E0\\u05E1\\u05D5\\u05EA \\u05E9\\u05D5\\u05D1\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(16, \"button\", 5);\n        ɵngcc0.ɵɵtext(17, \"\\u05D1\\u05D9\\u05D8\\u05D5\\u05DC\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        ɵngcc0.ɵɵadvance(10);\n        ɵngcc0.ɵɵproperty(\"href\", ctx.contact.website, ɵngcc0.ɵɵsanitizeUrl);\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵtextInterpolate(ctx.contact.name);\n        ɵngcc0.ɵɵadvance(3);\n        ɵngcc0.ɵɵproperty(\"mat-dialog-close\", true);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"mat-dialog-close\", false);\n      }\n    },\n    directives: [ɵngcc3.MatDialogcourse, ɵngcc4.MatIcon, ɵngcc3.MatDialogContent, ɵngcc3.MatDialogActions, ɵngcc5.MatButton, ɵngcc3.MatDialogClose],\n    styles: [_c0]\n  });\n  return UohPayUnreachableDialogComponent;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\nlet UohPayFailureContactComponent = /*#__PURE__*/(() => {\n  class UohPayFailureContactComponent {\n    constructor() {}\n\n  }\n\n  UohPayFailureContactComponent.ɵfac = function UohPayFailureContactComponent_Factory(t) {\n    return new (t || UohPayFailureContactComponent)();\n  };\n\n  UohPayFailureContactComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: UohPayFailureContactComponent,\n    selectors: [[\"uoh-pay-failure-contact\"]],\n    inputs: {\n      email: \"email\",\n      subject: \"subject\",\n      body: \"body\"\n    },\n    decls: 2,\n    vars: 1,\n    consts: [[\"mat-raised-button\", \"\", \"target\", \"_blank\", 3, \"href\"]],\n    template: function UohPayFailureContactComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵelementStart(0, \"a\", 0);\n        ɵngcc0.ɵɵtext(1, \" \\u05D3\\u05D9\\u05D5\\u05D5\\u05D7 \\u05E2\\u05DC \\u05EA\\u05E7\\u05DC\\u05D4\\n\");\n        ɵngcc0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        ɵngcc0.ɵɵproperty(\"href\", \"mailto:\" + ctx.email + \"?subject=\" + ctx.subject + \"&body=\" + ctx.body, ɵngcc0.ɵɵsanitizeUrl);\n      }\n    },\n    directives: [ɵngcc5.MatAnchor],\n    styles: [\"\"]\n  });\n  return UohPayFailureContactComponent;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\nlet UohPayFailureContactModule = /*#__PURE__*/(() => {\n  class UohPayFailureContactModule {}\n\n  UohPayFailureContactModule.ɵfac = function UohPayFailureContactModule_Factory(t) {\n    return new (t || UohPayFailureContactModule)();\n  };\n\n  UohPayFailureContactModule.ɵmod = /*@__PURE__*/ɵngcc0.ɵɵdefineNgModule({\n    type: UohPayFailureContactModule\n  });\n  UohPayFailureContactModule.ɵinj = /*@__PURE__*/ɵngcc0.ɵɵdefineInjector({\n    imports: [[CommonModule, MatButtonModule]]\n  });\n  return UohPayFailureContactModule;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(UohPayFailureContactModule, {\n    declarations: function () {\n      return [UohPayFailureContactComponent];\n    },\n    imports: function () {\n      return [CommonModule, MatButtonModule];\n    },\n    exports: function () {\n      return [UohPayFailureContactComponent];\n    }\n  });\n})();\n\nconst ɵ0 = UOH_PAY_DEFAULT_CONTACT;\nlet UohPayDialogModule = /*#__PURE__*/(() => {\n  class UohPayDialogModule {}\n\n  UohPayDialogModule.ɵfac = function UohPayDialogModule_Factory(t) {\n    return new (t || UohPayDialogModule)();\n  };\n\n  UohPayDialogModule.ɵmod = /*@__PURE__*/ɵngcc0.ɵɵdefineNgModule({\n    type: UohPayDialogModule\n  });\n  UohPayDialogModule.ɵinj = /*@__PURE__*/ɵngcc0.ɵɵdefineInjector({\n    providers: [{\n      provide: UOH_PAY_CONTACT,\n      useValue: ɵ0\n    }],\n    imports: [[CommonModule, MatDialogModule, MatIconModule, MatButtonModule, UohPayFailureContactModule]]\n  });\n  return UohPayDialogModule;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(UohPayDialogModule, {\n    declarations: function () {\n      return [UohPayCloseDialogComponent, UohPaySlowConnectionDialogComponent, UohPayUnreachableDialogComponent];\n    },\n    imports: function () {\n      return [CommonModule, MatDialogModule, MatIconModule, MatButtonModule, UohPayFailureContactModule];\n    },\n    exports: function () {\n      return [UohPayCloseDialogComponent, UohPaySlowConnectionDialogComponent, UohPayUnreachableDialogComponent];\n    }\n  });\n})();\n/**\r\n * Checks the connectivity with the webservice before proceeding with the payment.\r\n */\n\n\nlet UohPayConnectivity = /*#__PURE__*/(() => {\n  class UohPayConnectivity {\n    constructor(dialog, logger, pay) {\n      this.dialog = dialog;\n      this.logger = logger;\n      this.pay = pay;\n      this.TIMEOUT = 10000;\n      /**\r\n       * The status of the connection. Undefined if the connection is to be checked/re-checked.\r\n       */\n\n      this.ping = new BehaviorSubject(undefined);\n      this.subscription = new Subscription();\n    }\n\n    ngOnDestroy() {\n      this.subscription.unsubscribe();\n    }\n    /**\r\n     * Checks the connectivity and raises messages when the connection is slow or when the webservice cannot be reached.\r\n     * This method returns also the status of the payment.\r\n     * @param token The token to perform the check.\r\n     */\n\n\n    check(token) {\n      const ping$ = this.pay.get(token).pipe(map(payment => !!payment ? {\n        status: payment.status,\n        success: true\n      } : {\n        status: undefined,\n        success: false\n      }), catchError(error => {\n        this.logger.error(`[UohPayConnectivity.check] Cannot check connectivity: ${error}`);\n        return of({\n          status: undefined,\n          success: false\n        });\n      }), share());\n      this.subscription.add(timer(this.TIMEOUT).pipe(tap(_ => this.logger.debug(`[UohPayConnectivity.check] Slow connection alert after ${this.TIMEOUT} ms`)), takeUntil(ping$)).subscribe(_ => // TODO: Retrieve the direction from language settings.\n      this.dialog.open(UohPaySlowConnectionDialogComponent, {\n        direction: 'rtl',\n        disableClose: true\n      })));\n      this.subscription.add(ping$.subscribe(ping => this.handleStatus(token, ping)));\n      return this.ping.asObservable().pipe(filter(ping => ping !== undefined), distinctUntilChanged());\n    }\n    /**\r\n     * Handles the status of the check. If it fails it shows a message with the option to retry.\r\n     * @param token The token to perform the check.\r\n     * @param ping The result from the check.\r\n     */\n\n\n    handleStatus(token, ping) {\n      this.logger.debug(`[UohPayConnectivity.handleStatus] For token ${token} success: ${ping.success} status: ${ping.status}`);\n      this.dialog.closeAll();\n\n      if (!!ping.success) {\n        this.ping.next(ping);\n      } else {\n        // show retry message\n        this.subscription.add(this.dialog // TODO: Retrieve the direction from language settings.\n        .open(UohPayUnreachableDialogComponent, {\n          direction: 'rtl',\n          disableClose: true\n        }).afterClosed().subscribe(retry => {\n          if (retry) {\n            this.check(token);\n          } else {\n            this.logger.debug(`[UohPayConnectivity.handleStatus] For token ${token} unreachable`);\n            this.ping.next(ping);\n          }\n        }));\n      }\n    }\n\n  }\n\n  UohPayConnectivity.ɵfac = function UohPayConnectivity_Factory(t) {\n    return new (t || UohPayConnectivity)(ɵngcc0.ɵɵinject(ɵngcc3.MatDialog), ɵngcc0.ɵɵinject(ɵngcc2.UohLogger), ɵngcc0.ɵɵinject(UohPay));\n  };\n\n  UohPayConnectivity.ɵprov = /*@__PURE__*/ɵngcc0.ɵɵdefineInjectable({\n    token: UohPayConnectivity,\n    factory: UohPayConnectivity.ɵfac\n  });\n  return UohPayConnectivity;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n/**\r\n * Displays a terminal payment page in an iframe and handles the payment success or failure.\r\n */\n\n\nlet UohPayPageComponent = /*#__PURE__*/(() => {\n  class UohPayPageComponent {\n    constructor(sanitizer, dialog, logger, pay, deactivate, connectivity) {\n      this.sanitizer = sanitizer;\n      this.dialog = dialog;\n      this.logger = logger;\n      this.pay = pay;\n      this.deactivate = deactivate;\n      this.connectivity = connectivity;\n      /**\r\n       * Mock the payment postMessage - true for local development.\r\n       */\n\n      this.mock = false;\n      /**\r\n       * True to show a loading message.\r\n       */\n\n      this.loading$ = new BehaviorSubject(false);\n      /**\r\n       * The visibility of the payment iframe.\r\n       */\n\n      this.visibility$ = this.loading$.asObservable().pipe(map(loading => loading ? 'hidden' : 'visible'));\n      /**\r\n       * The width for the iframe.\r\n       */\n\n      this.width = '100%';\n      /**\r\n       * The height for the iframe.\r\n       */\n\n      this.height = '480';\n      /**\r\n       * The border for the iframe.\r\n       */\n\n      this.border = 0;\n      /**\r\n       * Fires true if the payment was successful, false otherwise.\r\n       */\n\n      this.paid = new EventEmitter();\n      /**\r\n       * Fires true if the payment service can be reached, false otherwise.\r\n       */\n\n      this.ping = new EventEmitter();\n      this.class = 'uoh-pay-page';\n      /**\r\n       * True if the user should be asked to confirm the component deactivation.\r\n       */\n\n      this.requestConfirmation = true;\n      this.subscription = new Subscription();\n    }\n    /**\r\n     * The url for the terminal to execute the payment.\r\n     */\n\n\n    set url(url) {\n      this.sanitizedUrl = this.sanitizer.bypassSecurityTrustResourceUrl(url);\n    }\n\n    ngOnInit() {\n      // Make sure that the service is available.\n      this.subscription.add(this.checkConnectivity().subscribe(paid => this.paid.emit(paid))); // Log the sanitized url for the terminal page.\n\n      const url = this.sanitizedUrl ? this.sanitizedUrl.toString() : undefined;\n      this.logger.info('[UohPayPageComponent.ngOnInit] - Payment initialized for url', url, 'for token', this.token); // Check if the component can be deactivated when the guard emits a deactivation request.\n\n      this.subscription.add(this.deactivate.init().pipe(switchMap(_ => this.canDeactivate())).subscribe(deactivate => this.deactivate.sendResponse(deactivate))); // Use the mock for local development.\n\n      this.mock = this.pay instanceof UohPayMock;\n    }\n\n    ngOnDestroy() {\n      this.deactivate.destroy();\n      this.subscription.unsubscribe();\n    }\n    /**\r\n     * Mock the postMessage mechanism for local development.\r\n     */\n\n\n    setMock() {\n      try {\n        this.pay.mock();\n      } catch (e) {\n        console.error('Cannot set the mock.');\n      }\n    }\n    /**\r\n     * This method will be called before the user closes, reloads or navigates away from this application.\r\n     * @param event The before unload event.\r\n     */\n\n\n    shouldExit(event) {\n      this.logger.log(UohLogLevel.DEBUG, '[UohPayPageComponent.shouldExit] Window before unload event occurred. Payment token:', this.token); // Ask the user if he/she really wants to unload this application.\n\n      event.preventDefault();\n      event.returnValue = 'התשלום טרם הסתיים?';\n      return false;\n    }\n    /**\r\n     * This method will be called when the payment iframe posts a message to this component (the parent window).\r\n     * @param event The message event from the iframe.\r\n     */\n\n\n    handleMessage(event) {\n      try {\n        this.logger.debug('[UohPayPageComponent.handleMessage] Handle message event:', JSON.stringify(event)); // Check if the message event from the iframe is from a valid origin (the payment service).\n\n        if (this.pay.isMessageValid(event)) {\n          this.loading$.next(true); // Wait until the payment service returns a completion status (either success or failure).\n          // Then, navigate to the corresponding route.\n\n          this.logger.debug('[UohPayPageComponent.handleMessage] The MessageEvent is valid.');\n          this.subscription.add(this.onComplete().pipe(tap(_ => this.requestConfirmation = false), tap(_ => this.loading$.next(false))).subscribe(success => this.paid.emit(success)));\n        }\n      } catch (e) {\n        const message = !!e && !!e.message ? e.message : 'No message';\n        this.logger.error('[UohPayPageComponent.handleMessage] Error:', message);\n      }\n    }\n    /**\r\n     * Returns true if the connectivity with the web service is OK, false otherwise.\r\n     */\n\n\n    checkConnectivity() {\n      this.loading$.next(true);\n      this.logger.debug(`[UohPayPageComponent.checkConnectivity] For token ${this.token}`);\n      return this.connectivity.check(this.token).pipe(tap(_ => this.loading$.next(false)), // This component can be deactivated if the connectivity check failed.\n      tap(ping => this.requestConfirmation = ping.success), // Emit the result of the availability check to the parent component.\n      tap(ping => this.ping.emit(ping.success)), // If the service is not available behave as in the case that the payment failed.\n      // Continue also if the payment status is success or failure.\n      filter(ping => !ping.success || !!ping.status && ping.status !== UohPayStatus.Pending), // Set as paid if the ping returned success for the payment status.\n      map(ping => ping.success && ping.status === UohPayStatus.Success));\n    }\n    /**\r\n     * This method will be called before each navigation from this component to verify if it can be deactivated.\r\n     */\n\n\n    canDeactivate() {\n      // If the status of the payment is still pending ask the user if he/she wants to navigate out.\n      if (this.pay.payment.status === UohPayStatus.Pending && this.requestConfirmation) {\n        this.logger.debug('[UohPayPageComponent.canDeactivate] Deactivating pending payment with token:', this.token);\n        return this.confirm();\n      } // If the payment was received (succedeed or failed) the user may navigate to another route.\n\n\n      return of(true);\n    }\n    /**\r\n     * Displays a confirmation dialog when the user tries to leave this route.\r\n     */\n\n\n    confirm() {\n      try {\n        return this.dialog // TODO: Retrieve the direction from the language settings.\n        .open(UohPayCloseDialogComponent, {\n          direction: 'rtl',\n          disableClose: true\n        }).afterClosed().pipe( // Coerce to boolean - convert undefined response to false.\n        map(deactivate => !!deactivate), tap(deactivate => this.logger.debug(`[UohPayPageComponent.confirm] Deactivation: ${deactivate}`)), // If the payment was received authorize the deactivation and emit the result using the paid event emitter.\n        switchMap(deactivate => this.checkPayment().pipe(map(_ => deactivate))));\n      } catch (e) {\n        const message = !!e && !!e.message ? e.message : 'No message';\n        this.logger.error('[UohPayPageComponent.confirm] Confirm error:', message);\n      }\n    }\n    /**\r\n     * Checks (once) if the payment was received (either successfull or failed).\r\n     * If so, it emits the result using the paid event emitter.\r\n     */\n\n\n    checkPayment() {\n      this.loading$.next(true);\n      this.logger.debug('[UohPayPageComponent.checkPayment] Check payment for token:', this.token);\n      return this.pay.get(this.token).pipe(catchError(error => {\n        this.logger.error(`[UohPayPageComponent.checkPayment] Check payment: ${error}`);\n        return of({\n          status: UohPayStatus.Pending\n        });\n      }), tap(payment => {\n        this.logger.info('[UohPayPageComponent.checkPayment] Check payment:', JSON.stringify(payment));\n\n        if (!!payment && payment.status !== UohPayStatus.Pending) {\n          const success = payment.status === UohPayStatus.Success;\n          this.paid.emit(success);\n        }\n\n        this.loading$.next(false);\n      }));\n    }\n    /**\r\n     * Fires when the payment is complete (checking with the stored token).\r\n     * It returns true if the payment is successful, false otherwise.\r\n     */\n\n\n    onComplete() {\n      return this.pay.onComplete(this.token).pipe(tap(payment => this.logger.info('[UohPayPageComponent.onComplete] On complete payment', JSON.stringify(payment))), map(payment => payment.status === UohPayStatus.Success), catchError(error => {\n        const message = !!error && !!error.message ? error.message : 'No message';\n        this.logger.error('[UohPayPageComponent.onComplete] On complete payment error:', message);\n        return of(false);\n      }));\n    }\n\n  }\n\n  UohPayPageComponent.ɵfac = function UohPayPageComponent_Factory(t) {\n    return new (t || UohPayPageComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc6.DomSanitizer), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.MatDialog), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.UohLogger), ɵngcc0.ɵɵdirectiveInject(UohPay), ɵngcc0.ɵɵdirectiveInject(UohPayDeactivate), ɵngcc0.ɵɵdirectiveInject(UohPayConnectivity));\n  };\n\n  UohPayPageComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: UohPayPageComponent,\n    selectors: [[\"uoh-pay-page\"]],\n    hostVars: 2,\n    hostBindings: function UohPayPageComponent_HostBindings(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵlistener(\"beforeunload\", function UohPayPageComponent_beforeunload_HostBindingHandler($event) {\n          return ctx.shouldExit($event);\n        }, false, ɵngcc0.ɵɵresolveWindow)(\"message\", function UohPayPageComponent_message_HostBindingHandler($event) {\n          return ctx.handleMessage($event);\n        }, false, ɵngcc0.ɵɵresolveWindow);\n      }\n\n      if (rf & 2) {\n        ɵngcc0.ɵɵclassMap(ctx.class);\n      }\n    },\n    inputs: {\n      width: \"width\",\n      height: \"height\",\n      border: \"border\",\n      url: \"url\",\n      token: \"token\"\n    },\n    outputs: {\n      paid: \"paid\",\n      ping: \"ping\"\n    },\n    features: [ɵngcc0.ɵɵProvidersFeature([UohPayConnectivity])],\n    decls: 5,\n    vars: 12,\n    consts: [[4, \"ngIf\"], [3, \"src\"], [3, \"click\", 4, \"ngIf\"], [\"mode\", \"indeterminate\", \"color\", \"accent\"], [1, \"uoh-pay-page-row\"], [3, \"click\"]],\n    template: function UohPayPageComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵtemplate(0, UohPayPageComponent_ng_container_0_Template, 7, 0, \"ng-container\", 0);\n        ɵngcc0.ɵɵpipe(1, \"async\");\n        ɵngcc0.ɵɵelementStart(2, \"iframe\", 1);\n        ɵngcc0.ɵɵpipe(3, \"async\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(4, UohPayPageComponent_button_4_Template, 2, 0, \"button\", 2);\n      }\n\n      if (rf & 2) {\n        ɵngcc0.ɵɵproperty(\"ngIf\", ɵngcc0.ɵɵpipeBind1(1, 8, ctx.loading$));\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵstyleProp(\"visibility\", ɵngcc0.ɵɵpipeBind1(3, 10, ctx.visibility$));\n        ɵngcc0.ɵɵproperty(\"src\", ctx.sanitizedUrl, ɵngcc0.ɵɵsanitizeResourceUrl);\n        ɵngcc0.ɵɵattribute(\"width\", ctx.width)(\"height\", ctx.height)(\"frameborder\", ctx.border);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.mock);\n      }\n    },\n    directives: [ɵngcc7.NgIf, ɵngcc8.MatProgressBar],\n    pipes: [ɵngcc7.AsyncPipe],\n    styles: [\".uoh-pay-page-row[_ngcontent-%COMP%]{margin:16px 0}\"]\n  });\n  return UohPayPageComponent;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\nlet UohPayPageModule = /*#__PURE__*/(() => {\n  class UohPayPageModule {}\n\n  UohPayPageModule.ɵfac = function UohPayPageModule_Factory(t) {\n    return new (t || UohPayPageModule)();\n  };\n\n  UohPayPageModule.ɵmod = /*@__PURE__*/ɵngcc0.ɵɵdefineNgModule({\n    type: UohPayPageModule\n  });\n  UohPayPageModule.ɵinj = /*@__PURE__*/ɵngcc0.ɵɵdefineInjector({\n    imports: [[CommonModule, MatProgressBarModule, UohPayDialogModule]]\n  });\n  return UohPayPageModule;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(UohPayPageModule, {\n    declarations: function () {\n      return [UohPayPageComponent];\n    },\n    imports: function () {\n      return [CommonModule, MatProgressBarModule, UohPayDialogModule];\n    },\n    exports: function () {\n      return [UohPayPageComponent];\n    }\n  });\n})();\n\nlet UohPaySuccessComponent = /*#__PURE__*/(() => {\n  class UohPaySuccessComponent {\n    constructor(logger) {\n      this.logger = logger;\n      this.types = UOH_PAY_TYPE_NAME_HE;\n      this.class = 'uoh-pay-success';\n    }\n\n    ngOnInit() {\n      this.logger.info('[UohPaySuccessComponent.ngOnInit] Payment success:', JSON.stringify(this.payment));\n    }\n\n  }\n\n  UohPaySuccessComponent.ɵfac = function UohPaySuccessComponent_Factory(t) {\n    return new (t || UohPaySuccessComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc2.UohLogger));\n  };\n\n  UohPaySuccessComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: UohPaySuccessComponent,\n    selectors: [[\"uoh-pay-success\"]],\n    hostVars: 2,\n    hostBindings: function UohPaySuccessComponent_HostBindings(rf, ctx) {\n      if (rf & 2) {\n        ɵngcc0.ɵɵclassMap(ctx.class);\n      }\n    },\n    inputs: {\n      payment: \"payment\"\n    },\n    decls: 35,\n    vars: 14,\n    consts: [[\"role\", \"rowgroup\", 1, \"uoh-pay-success-wrapper\"], [\"role\", \"row\", 1, \"uoh-pay-success-row\", \"uoh-success\"], [\"role\", \"row\", 1, \"uoh-pay-success-row\"], [1, \"uoh-pay-success-label\"], [1, \"uoh-pay-success-value\"], [4, \"ngIf\"], [\"class\", \"uoh-pay-success-row\", \"role\", \"row\", 4, \"ngIf\"]],\n    template: function UohPaySuccessComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵelementStart(0, \"div\", 0);\n        ɵngcc0.ɵɵelementStart(1, \"div\", 1);\n        ɵngcc0.ɵɵtext(2, \"\\u05D4\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD \\u05D4\\u05EA\\u05E7\\u05D1\\u05DC \\u05D1\\u05D4\\u05E6\\u05DC\\u05D7\\u05D4\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(3, \"div\", 2);\n        ɵngcc0.ɵɵelementStart(4, \"span\", 3);\n        ɵngcc0.ɵɵtext(5, \" \\u05E1\\u05D4\\u05F4\\u05DB \\u05D4\\u05E1\\u05DB\\u05D5\\u05DD \\u05E9\\u05E9\\u05D5\\u05DC\\u05DD: \");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(6, \"span\", 4);\n        ɵngcc0.ɵɵtext(7);\n        ɵngcc0.ɵɵpipe(8, \"currency\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelement(9, \"mat-divider\");\n        ɵngcc0.ɵɵelementStart(10, \"div\", 2);\n        ɵngcc0.ɵɵelementStart(11, \"span\", 3);\n        ɵngcc0.ɵɵtext(12, \" \\u05DE\\u05E1\\u05E4\\u05E8 \\u05D0\\u05D9\\u05E9\\u05D5\\u05E8: \");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(13, \"span\", 4);\n        ɵngcc0.ɵɵtext(14);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelement(15, \"mat-divider\");\n        ɵngcc0.ɵɵelementStart(16, \"div\", 2);\n        ɵngcc0.ɵɵelementStart(17, \"span\", 3);\n        ɵngcc0.ɵɵtext(18, \" \\u05EA\\u05D0\\u05E8\\u05D9\\u05DA \\u05D4\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD: \");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(19, \"span\", 4);\n        ɵngcc0.ɵɵtext(20);\n        ɵngcc0.ɵɵpipe(21, \"date\");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelement(22, \"mat-divider\");\n        ɵngcc0.ɵɵelementStart(23, \"div\", 2);\n        ɵngcc0.ɵɵelementStart(24, \"span\", 3);\n        ɵngcc0.ɵɵtext(25, \" \\u05E9\\u05D5\\u05DC\\u05DD \\u05D1\\u05DB\\u05E8\\u05D8\\u05D9\\u05E1 \\u05E9\\u05DE\\u05E1\\u05EA\\u05D9\\u05D9\\u05DD \\u05D1\\u05E1\\u05E4\\u05E8\\u05D5\\u05EA: \");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(26, \"span\", 4);\n        ɵngcc0.ɵɵtext(27);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelement(28, \"mat-divider\");\n        ɵngcc0.ɵɵelementStart(29, \"div\", 2);\n        ɵngcc0.ɵɵelementStart(30, \"span\", 3);\n        ɵngcc0.ɵɵtext(31, \" \\u05D0\\u05D5\\u05E4\\u05DF \\u05D4\\u05EA\\u05E9\\u05DC\\u05D5\\u05DD: \");\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementStart(32, \"span\", 4);\n        ɵngcc0.ɵɵtext(33);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵtemplate(34, UohPaySuccessComponent_ng_container_34_Template, 7, 3, \"ng-container\", 5);\n        ɵngcc0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        ɵngcc0.ɵɵadvance(7);\n        ɵngcc0.ɵɵtextInterpolate1(\" \", ɵngcc0.ɵɵpipeBind4(8, 6, ctx.payment.sum, ctx.payment.currency, \"symbol\", \"1.2-2\"), \" \");\n        ɵngcc0.ɵɵadvance(7);\n        ɵngcc0.ɵɵtextInterpolate1(\" \", ctx.payment.confirmationCode, \" \");\n        ɵngcc0.ɵɵadvance(6);\n        ɵngcc0.ɵɵtextInterpolate1(\" \", ɵngcc0.ɵɵpipeBind2(21, 11, ctx.payment.receivedAt, \"dd/MM/yyyy HH:mm:ss\"), \" \");\n        ɵngcc0.ɵɵadvance(7);\n        ɵngcc0.ɵɵtextInterpolate1(\" \", ctx.payment.cardNumber, \" \");\n        ɵngcc0.ɵɵadvance(6);\n        ɵngcc0.ɵɵtextInterpolate1(\" \", ctx.types[ctx.payment.type], \" \");\n        ɵngcc0.ɵɵadvance(1);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.payment.installments);\n      }\n    },\n    directives: [ɵngcc9.MatDivider, ɵngcc7.NgIf],\n    pipes: [ɵngcc7.CurrencyPipe, ɵngcc7.DatePipe],\n    styles: [\".uoh-pay-success-wrapper[_ngcontent-%COMP%], .uoh-success[_ngcontent-%COMP%]{margin:16px 0}.uoh-success[_ngcontent-%COMP%]{font-weight:700}.uoh-pay-success-row[_ngcontent-%COMP%]{align-items:center;display:flex;padding:16px 0}.uoh-pay-success-row[_ngcontent-%COMP%]   .uoh-pay-success-label[_ngcontent-%COMP%]{flex-basis:16em;font-weight:700;margin-right:16px;text-transform:uppercase}[dir=rtl][_nghost-%COMP%]   .uoh-pay-success-row[_ngcontent-%COMP%]   .uoh-pay-success-label[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   .uoh-pay-success-row[_ngcontent-%COMP%]   .uoh-pay-success-label[_ngcontent-%COMP%]{margin-left:16px;margin-right:0}@media screen and (max-width:599.99px){.uoh-pay-success-row[_ngcontent-%COMP%]{display:block}.uoh-pay-success-row[_ngcontent-%COMP%]   .uoh-pay-success-label[_ngcontent-%COMP%], .uoh-pay-success-row[_ngcontent-%COMP%]   .uoh-pay-success-value[_ngcontent-%COMP%]{display:block;width:100%}.uoh-pay-success-row[_ngcontent-%COMP%]   .uoh-pay-success-value[_ngcontent-%COMP%]{margin-top:8px}}.uoh-pay-success-row[_ngcontent-%COMP%]   .uoh-pay-success-label[_ngcontent-%COMP%]{opacity:.6}\"]\n  });\n  return UohPaySuccessComponent;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\nlet UohPaySuccessModule = /*#__PURE__*/(() => {\n  class UohPaySuccessModule {}\n\n  UohPaySuccessModule.ɵfac = function UohPaySuccessModule_Factory(t) {\n    return new (t || UohPaySuccessModule)();\n  };\n\n  UohPaySuccessModule.ɵmod = /*@__PURE__*/ɵngcc0.ɵɵdefineNgModule({\n    type: UohPaySuccessModule\n  });\n  UohPaySuccessModule.ɵinj = /*@__PURE__*/ɵngcc0.ɵɵdefineInjector({\n    imports: [[CommonModule, MatDividerModule]]\n  });\n  return UohPaySuccessModule;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(UohPaySuccessModule, {\n    declarations: function () {\n      return [UohPaySuccessComponent];\n    },\n    imports: function () {\n      return [CommonModule, MatDividerModule];\n    },\n    exports: function () {\n      return [UohPaySuccessComponent];\n    }\n  });\n})();\n\nlet UohPayFailureComponent = /*#__PURE__*/(() => {\n  class UohPayFailureComponent {\n    constructor(logger, contact) {\n      this.logger = logger;\n      this.contact = contact;\n      this.status = UohPayStatus;\n      this.class = 'uoh-pay-failure';\n    }\n\n    ngOnInit() {\n      this.logger.error(`[UohPayFailureComponent.ngOnInit] Payment failed for token ${this.token} with status ${this.payment.status}.`);\n    }\n\n  }\n\n  UohPayFailureComponent.ɵfac = function UohPayFailureComponent_Factory(t) {\n    return new (t || UohPayFailureComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc2.UohLogger), ɵngcc0.ɵɵdirectiveInject(UOH_PAY_CONTACT));\n  };\n\n  UohPayFailureComponent.ɵcmp = /*@__PURE__*/ɵngcc0.ɵɵdefineComponent({\n    type: UohPayFailureComponent,\n    selectors: [[\"uoh-pay-failure\"]],\n    hostVars: 2,\n    hostBindings: function UohPayFailureComponent_HostBindings(rf, ctx) {\n      if (rf & 2) {\n        ɵngcc0.ɵɵclassMap(ctx.class);\n      }\n    },\n    inputs: {\n      payment: \"payment\",\n      token: \"token\"\n    },\n    decls: 3,\n    vars: 2,\n    consts: [[4, \"ngIf\", \"ngIfElse\"], [\"pendingTemplate\", \"\"], [1, \"uoh-error\", \"uoh-pay-failure-row\"], [\"class\", \"uoh-error uoh-pay-failure-row\", 4, \"ngIf\"], [\"target\", \"_blank\", 3, \"href\"], [4, \"ngIf\"], [1, \"uoh-pay-failure-row\"], [3, \"email\", \"subject\", \"body\"]],\n    template: function UohPayFailureComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵtemplate(0, UohPayFailureComponent_ng_container_0_Template, 5, 1, \"ng-container\", 0);\n        ɵngcc0.ɵɵtemplate(1, UohPayFailureComponent_ng_template_1_Template, 10, 3, \"ng-template\", null, 1, ɵngcc0.ɵɵtemplateRefExtractor);\n      }\n\n      if (rf & 2) {\n        const _r1 = ɵngcc0.ɵɵreference(2);\n\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.payment.status === ctx.status.Failure)(\"ngIfElse\", _r1);\n      }\n    },\n    directives: [ɵngcc7.NgIf, UohPayFailureContactComponent],\n    styles: [\".uoh-pay-failure-row[_ngcontent-%COMP%]{margin:16px 0}\"]\n  });\n  return UohPayFailureComponent;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\nconst ɵ0$1 = UOH_PAY_DEFAULT_CONTACT;\nlet UohPayFailureModule = /*#__PURE__*/(() => {\n  class UohPayFailureModule {}\n\n  UohPayFailureModule.ɵfac = function UohPayFailureModule_Factory(t) {\n    return new (t || UohPayFailureModule)();\n  };\n\n  UohPayFailureModule.ɵmod = /*@__PURE__*/ɵngcc0.ɵɵdefineNgModule({\n    type: UohPayFailureModule\n  });\n  UohPayFailureModule.ɵinj = /*@__PURE__*/ɵngcc0.ɵɵdefineInjector({\n    providers: [{\n      provide: UOH_PAY_CONTACT,\n      useValue: ɵ0$1\n    }],\n    imports: [[CommonModule, UohPayFailureContactModule]]\n  });\n  return UohPayFailureModule;\n})();\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && void 0;\n})();\n\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(UohPayFailureModule, {\n    declarations: function () {\n      return [UohPayFailureComponent];\n    },\n    imports: function () {\n      return [CommonModule, UohPayFailureContactModule];\n    },\n    exports: function () {\n      return [UohPayFailureComponent];\n    }\n  });\n})();\n/*\r\n * Public API Surface of ngx-pay\r\n */\n\n/**\r\n * Generated bundle index. Do not edit.\r\n */\n\n\nexport { UOH_PAY_CONFIG, UOH_PAY_CONTACT, UOH_PAY_CURRENCY_ID, UOH_PAY_DARK_THEME, UOH_PAY_DEFAULT_THEME, UOH_PAY_TYPE_ID, UOH_PAY_TYPE_NAME_HE, UohPay, UohPayCurrency, UohPayDeactivateGuard, UohPayFailureComponent, UohPayFailureModule, UohPayLanguage, UohPayMockModule, UohPayModule, UohPayPageComponent, UohPayPageModule, UohPayStatus, UohPaySuccessComponent, UohPaySuccessModule, UohPayType, UohPayUrlBuilder, ɵ0$1 as ɵ0, UOH_PAY_DEFAULT_API as ɵa, UOH_PAY_DEFAULT_OPTIONS as ɵb, UOH_PAY_DEFAULT_CONTACT as ɵc, UOH_PAY_OPTIONS as ɵd, resolvePaymentConfig as ɵe, resolvePaymentService as ɵf, resolveMockService as ɵg, UohPayMock as ɵh, UohPayDeactivate as ɵi, UohPayDialogModule as ɵj, UohPayFailureContactModule as ɵk, UohPayFailureContactComponent as ɵl, UohPayCloseDialogComponent as ɵm, UohPaySlowConnectionDialogComponent as ɵn, UohPayUnreachableDialogComponent as ɵo, UohPayConnectivity as ɵp }; //# sourceMappingURL=haifauniversity-ngx-pay.js.map","map":null,"metadata":{},"sourceType":"module"}