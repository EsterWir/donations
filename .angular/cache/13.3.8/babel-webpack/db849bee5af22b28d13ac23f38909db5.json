{"ast":null,"code":"import { Subscription } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./shared/services/environment.service\";\nimport * as i2 from \"@ngx-translate/core\";\nimport * as i3 from \"@haifauniversity/ngx-tools\";\nimport * as i4 from \"@haifauniversity/ngx-pay\";\nimport * as i5 from \"./shared/services/user-info/user-info.service\";\nimport * as i6 from \"./shared/services/user-info/user-info-store.service\";\nimport * as i7 from \"@uoh/ngx-theme\";\nimport * as i8 from \"@angular/cdk/bidi\";\nimport * as i9 from \"@angular/common\";\nimport * as i10 from \"~shared/components/languages-select/languages-select.component\";\nimport * as i11 from \"@angular/router\";\n\nfunction AppComponent_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"uoh-header\", 6);\n    i0.ɵɵlistener(\"logOut\", function AppComponent_ng_container_2_Template_uoh_header_logOut_1_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.logout();\n    });\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"header\", i0.ɵɵpipeBind1(2, 3, \"APP_course\"))(\"user\", ctx_r0.user)(\"logoLinkUrl\", \"https://donations.haifa.ac.il/he/landing-1/\");\n  }\n}\n\nfunction AppComponent_ng_template_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"uoh-header\", 7);\n    i0.ɵɵpipe(1, \"translate\");\n  }\n\n  if (rf & 2) {\n    i0.ɵɵproperty(\"header\", i0.ɵɵpipeBind1(1, 2, \"APP_course\"))(\"logoLinkUrl\", \"https://donations.haifa.ac.il/he/landing-1/\");\n  }\n}\n\nexport let AppComponent = /*#__PURE__*/(() => {\n  class AppComponent {\n    constructor(env, translate, platform, logger, pay, userInfo, userInfoStore) {\n      this.env = env;\n      this.translate = translate;\n      this.platform = platform;\n      this.logger = logger;\n      this.pay = pay;\n      this.userInfo = userInfo;\n      this.userInfoStore = userInfoStore;\n      this.direction = 'rtl';\n      this.subscription = new Subscription();\n      this.version = this.env.getVersion();\n      this.translate.addLangs(this.env.getLanguages());\n      this.translate.setDefaultLang(this.env.getLocale());\n      this.translate.use(this.env.getLocale());\n    }\n\n    get user() {\n      let name = this.userInfoStore.englishName;\n\n      if (this.lang === this.env.getLocale()) {\n        name = `${this.userInfoStore.firstName} ${this.userInfoStore.lastName}`;\n      }\n\n      return {\n        name\n      };\n    }\n\n    get lang() {\n      return this.translate.currentLang;\n    }\n\n    ngOnInit() {\n      this.pay.reset();\n      this.subscribeLangChange();\n\n      if (this.userInfo.isStudent()) {\n        this.login();\n      }\n\n      this.logger.debug(this.platform.getInfo());\n    }\n\n    ngOnDestroy() {\n      this.subscription.unsubscribe();\n    }\n\n    subscribeLangChange() {\n      this.subscription.add(this.translate.onLangChange.subscribe(({\n        lang\n      }) => {\n        window.setTimeout(() => {\n          if (lang === this.env.getForeignLocale()) {\n            this.direction = 'ltr';\n          } else {\n            this.direction = 'rtl';\n          }\n        }, 100);\n      }));\n    }\n\n    login() {\n      this.subscription.add(this.userInfo.init().subscribe(({\n        id\n      }) => {\n        if (id && id[0] === '9') {\n          this.translate.setDefaultLang(this.env.getForeignLocale());\n          this.translate.use(this.env.getForeignLocale());\n        }\n      }));\n    }\n\n    logout() {\n      window.location.href = `${this.env.getOriginUrl()}/logout`;\n    }\n\n    isStudent() {\n      return this.userInfo.isStudent();\n    }\n\n  }\n\n  AppComponent.ɵfac = function AppComponent_Factory(t) {\n    return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.EnvironmentService), i0.ɵɵdirectiveInject(i2.TranslateService), i0.ɵɵdirectiveInject(i3.UohPlatform), i0.ɵɵdirectiveInject(i3.UohLogger), i0.ɵɵdirectiveInject(i4.UohPay), i0.ɵɵdirectiveInject(i5.UserInfoService), i0.ɵɵdirectiveInject(i6.UserInfoStoreService));\n  };\n\n  AppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AppComponent,\n    selectors: [[\"app-root\"]],\n    decls: 10,\n    vars: 5,\n    consts: [[3, \"dir\", \"lang\"], [4, \"ngIf\", \"ngIfElse\"], [\"guestHeader\", \"\"], [1, \"fake-header\"], [1, \"langSelect\"], [3, \"version\"], [3, \"header\", \"user\", \"logoLinkUrl\", \"logOut\"], [3, \"header\", \"logoLinkUrl\"]],\n    template: function AppComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"uoh-accessibility\", 0);\n        i0.ɵɵelement(1, \"uoh-spinner\");\n        i0.ɵɵtemplate(2, AppComponent_ng_container_2_Template, 3, 5, \"ng-container\", 1);\n        i0.ɵɵtemplate(3, AppComponent_ng_template_3_Template, 2, 4, \"ng-template\", null, 2, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelementStart(5, \"div\", 3);\n        i0.ɵɵelement(6, \"app-languages-select\", 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(7, \"uoh-back-to-top\");\n        i0.ɵɵelement(8, \"router-outlet\");\n        i0.ɵɵelement(9, \"uoh-footer\", 5);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(4);\n\n        i0.ɵɵproperty(\"dir\", ctx.direction)(\"lang\", ctx.lang);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.isStudent())(\"ngIfElse\", _r1);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"version\", ctx.version);\n      }\n    },\n    directives: [i7.ɵd, i8.Dir, i7.ɵe, i9.NgIf, i10.LanguagesSelectComponent, i7.ɵj, i11.RouterOutlet, i7.ɵk, i7.ɵf],\n    pipes: [i2.TranslatePipe],\n    styles: [\".fake-header[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:flex-end;align-items:center;height:30px;margin-top:-32px;box-sizing:border-box;padding:0 .5rem}\"]\n  });\n  return AppComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}